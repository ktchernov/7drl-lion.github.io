var jsfx={};
(function(){this.Parameters=[];this.Generators={square:audio.generators.square,saw:audio.generators.saw,triangle:audio.generators.triangle,sine:audio.generators.sine,noise:audio.generators.noise,synth:audio.generators.synth};this.getGeneratorNames=function(){var a=[],d;for(d in this.Generators)a.push(d);return a};this.getParameters=function(){var a=[],d=0,b=function(b,c,g,f,r){void 0===r&&(r=(g-c)/1E3);b={name:b,id:b.replace(/ /g,""),min:c,max:g,step:r,def:f,type:"range",group:d};a.push(b)},f=this.getGeneratorNames();
(function(b,c,f){b={name:b,id:b.replace(/ /g,""),options:c,def:f,type:"option",group:d};a.push(b)})("Generator",f,f[0]);b("Super Sampling Quality",0,16,0,1);b("Master Volume",0,1,.4);d++;b("Attack Time",0,1,.1);b("Sustain Time",0,2,.3);b("Sustain Punch",0,3,2);b("Decay Time",0,2,1);d++;b("Min Frequency",20,2400,0,1);b("Start Frequency",20,2400,440,1);b("Max Frequency",20,2400,2E3,1);b("Slide",-1,1,0);b("Delta Slide",-1,1,0);d++;b("Vibrato Depth",0,1,0);b("Vibrato Frequency",.01,48,8);b("Vibrato Depth Slide",
-.3,1,0);b("Vibrato Frequency Slide",-1,1,0);d++;b("Change Amount",-1,1,0);b("Change Speed",0,1,.1);d++;b("Square Duty",0,.5,0);b("Square Duty Sweep",-1,1,0);d++;b("Repeat Speed",0,.8,0);d++;b("Phaser Offset",-1,1,0);b("Phaser Sweep",-1,1,0);d++;b("LP Filter Cutoff",0,1,1);b("LP Filter Cutoff Sweep",-1,1,0);b("LP Filter Resonance",0,1,0);b("HP Filter Cutoff",0,1,0);b("HP Filter Cutoff Sweep",-1,1,0);return a};this.generate=function(a){var d=2*Math.PI,b=Math.sin,f=Math.pow,M=Math.abs,c=audio.SampleRate,
g=a.SuperSamplingQuality|0;1>g&&(g=1);for(var c=c*g,z=[{from:0,to:1,time:a.AttackTime},{from:1+a.SustainPunch,to:1,time:a.SustainTime},{from:1,to:0,time:a.DecayTime}],r=z.length,e=0;e<r;e++)z[e].samples=1+(z[e].time*c|0);for(var l=void 0,D=0,E=-1,V=0,N=-1,m=0,e=0;e<r;e++)m+=z[e].samples;m<c/2&&(m=c/2);var O=Array(m/g|0),h=0,F=0,P=jsfx.Generators[a.Generator];void 0===P&&(P=this.Generators.square);var p=0,p=a.SquareDuty,Z=a.SquareDutySweep/c,v=0,k=a.StartFrequency*d/c,G=1+64*f(a.Slide,3)/c,w=f(a.DeltaSlide,
3)/(1E3*c);void 0!==g&&(w/=g);a.MinFrequency>a.StartFrequency&&(a.MinFrequency=a.StartFrequency);a.MaxFrequency<a.StartFrequency&&(a.MaxFrequency=a.StartFrequency);for(var W=a.MinFrequency*d/c,X=a.MaxFrequency*d/c,Q=0,R=a.VibratoFrequency*d/c,t=a.VibratoDepth,aa=1+3*f(a.VibratoFrequencySlide,3)/c,H=a.VibratoDepthSlide/c,I=0,S=a.ChangeSpeed*c,A=f(a.ChangeAmount,2),A=0<a.ChangeAmount?1+10*A:1-.9*A,T=Array(1024),e=0;1024>e;e++)T[e]=0;var J=0,n=1020*f(a.PhaserOffset,2),B=4E3*f(a.PhaserSweep,3)/c,ba=1E-5<
M(B)||1E-5<M(n),ca=.001<a.HPFilterCutoff||.999>a.LPFilterCutoff,x=0,y=0,u=f(a.LPFilterCutoff,3)/10,da=1+a.HPFilterCutoffSweep/1E4,C=5/(1+20*f(a.LPFilterResonance,2))*(.01+a.LPFilterCutoff);.8<C&&(C=.8);var C=1-C,ea=.999>a.LPFilterCutoff,K=0,q=f(a.HPFilterCutoff,2)/10,fa=1+a.HPFilterCutoffSweep/1E4,L=0,Y=m;0<a.RepeatSpeed&&(Y=f(1-a.RepeatSpeed,2)*c+32);for(var ga=a.MasterVolume,U=0,e=0;e<m;e++)h=P(v,p,0),p+=Z,0>p?p=0:.5<p&&(p=.5),L>Y&&(v=0,k=a.StartFrequency*d/c,G=1+3*f(a.Slide,3)/c,w=f(a.DeltaSlide,
3)/(1E3*c),void 0!==g&&(w/=g),I=0,S=a.ChangeSpeed*c,A=1+(a.ChangeAmount|0)/12,L=0),L+=1,v+=k,G+=w,k*=G,I>S&&(k*=A,S=m),I+=1,k>X?k=X:k<W&&(k=W),Q+=R,l=k*b(Q)*t,v+=l,R*=aa,H&&(t+=H,0>t?H=t=0:1<t&&(t=1,H=0)),ca&&(.001<M(q)&&(q*=fa,1E-5>q?q=1E-5:.1<q&&(q=.1)),l=x,u*=da,0>u?u=0:.1<u&&(u=.1),ea?(y+=(h-x)*u,y*=C):(x=h,y=0),x+=y,K+=x-l,h=K*=1-q),ba&&(n+=B,0>n&&(n=-n,B=-B),1023<n&&(n=1023,B=0),T[J]=h,h+=T[J-(n|0)+1024&1023],J=J+1&1023),e>N&&(E+=1,l=E<r?z[E]:{from:0,to:0,samples:m},D=l.from,V=(l.to-l.from)/
(l.samples+1),N+=l.samples),h*=D,D+=V,h*=ga,1<g?(F+=h,0===(e+1)%g&&(O[U]=F/g,U+=1,F=0)):O[e]=h;a=c/100|0;d=Array(a);for(e=0;e<a;e++)d[e]=0;return d.concat(O).concat(d)};this.Parameters=this.getParameters()}).apply(jsfx);
